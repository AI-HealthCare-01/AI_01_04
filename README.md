<<<<<<< HEAD
# AI Healthcare Project Template

ì´ í”„ë¡œì íŠ¸ëŠ” AI ëª¨ë¸ ì¶”ë¡ (Inference) ì›Œì»¤ì™€ FastAPI API ì„œë²„ë¥¼ í†µí•©í•œ ì„œë¹„ìŠ¤ í…œí”Œë¦¿ìž…ë‹ˆë‹¤. 
í˜„ëŒ€ì ì¸ Python íŒ¨í‚¤ì§€ ê´€ë¦¬ ë„êµ¬ì¸ `uv`ì™€ ì»¨í…Œì´ë„ˆí™” ë„êµ¬ì¸ `Docker`ë¥¼ í™œìš©í•˜ì—¬ ì¼ê´€ëœ ê°œë°œ ë° ë°°í¬ í™˜ê²½ì„ ì œê³µí•©ë‹ˆë‹¤.

---

## ðŸš€ ì£¼ìš” íŠ¹ì§•

- **FastAPI Framework**: ê³ ì„±ëŠ¥ ë¹„ë™ê¸° API ì„œë²„ êµ¬í˜„.
- **AI Worker**: ëª¨ë¸ ì¶”ë¡  ë° í•™ìŠµ ìž‘ì—…ì„ API ì„œë²„ì™€ ë¶„ë¦¬í•˜ì—¬ ì²˜ë¦¬.
- **UV Package Manager**: ë§¤ìš° ë¹ ë¥¸ ì˜ì¡´ì„± ì„¤ì¹˜ ë° ê°€ìƒí™˜ê²½ ê´€ë¦¬.
- **Tortoise ORM**: ë¹„ë™ê¸° ë°©ì‹ì˜ ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸ë§ ë° ì¿¼ë¦¬ ê´€ë¦¬.
- **Docker-Compose**: MySQL, Redis, Nginxë¥¼ í¬í•¨í•œ ì „ì²´ ì„œë¹„ìŠ¤ ìŠ¤íƒì„ í•œ ë²ˆì— ì‹¤í–‰.
- **CI/CD Scripts**: ì½”ë“œ í¬ë§·íŒ…(Ruff), íƒ€ìž… ì²´í¬(Mypy), í…ŒìŠ¤íŠ¸(Pytest)ë¥¼ ìœ„í•œ ìžë™í™” ìŠ¤í¬ë¦½íŠ¸ ì œê³µ.

---

## ðŸ“‚ í”„ë¡œì íŠ¸ êµ¬ì¡°

```text
.
â”œâ”€â”€ ai_worker/          # AI ëª¨ë¸ ì¶”ë¡  ë° í•™ìŠµ ê´€ë ¨ ì½”ë“œ (Worker)
â”‚   â”œâ”€â”€ core/           # ì›Œì»¤ ì„¤ì • ë° ë¡œê±°
â”‚   â”œâ”€â”€ models/         # AI ëª¨ë¸ íŒŒì¼ ë³´ê´€ (PyTorch ë“±)
â”‚   â”œâ”€â”€ tasks/          # ì‹¤ì œ ì²˜ë¦¬í•  ìž‘ì—… ì •ì˜
â”‚   â””â”€â”€ main.py         # ì›Œì»¤ ì§„ìž…ì 
â”œâ”€â”€ app/                # FastAPI ì„œë²„ ì½”ë“œ
â”‚   â”œâ”€â”€ apis/           # API ë¼ìš°í„° (v1 ë²„ì „ ê´€ë¦¬)
â”‚   â”œâ”€â”€ core/           # ì„œë²„ ì„¤ì • (pydantic-settings)
â”‚   â”œâ”€â”€ db/             # ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™” ë° ë§ˆì´ê·¸ë ˆì´ì…˜ (Tortoise ORM)
â”‚   â”œâ”€â”€ dtos/           # ë°ì´í„° ì „ì†¡ ê°ì²´ (Pydantic models)
â”‚   â”œâ”€â”€ models/         # DB í…Œì´ë¸” ì •ì˜
â”‚   â”œâ”€â”€ services/       # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â””â”€â”€ main.py         # FastAPI ì• í”Œë¦¬ì¼€ì´ì…˜ ì§„ìž…ì 
â”œâ”€â”€ envs/               # í™˜ê²½ ë³€ìˆ˜ ì„¤ì • íŒŒì¼ (.env)
â”œâ”€â”€ nginx/              # Nginx ì„¤ì • íŒŒì¼ (ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ)
â”œâ”€â”€ scripts/            # ë°°í¬ ë° CIìš© ì‰˜ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ docker-compose.yml  # ì „ì²´ ì„œë¹„ìŠ¤ ì‹¤í–‰ ì„¤ì •
â””â”€â”€ pyproject.toml      # uv ê¸°ë°˜ ì˜ì¡´ì„± ê´€ë¦¬ ì„¤ì •
```

---

## âš™ï¸ ì‚¬ì „ ì¤€ë¹„ ì‚¬í•­

- **Python**: 3.13 ì´ìƒ (ë¡œì»¬ ê°œë°œ í™˜ê²½ìš©)
- **UV**: Python íŒ¨í‚¤ì§€ ë§¤ë‹ˆì € ([ì„¤ì¹˜ ê°€ì´ë“œ](https://github.com/astral-sh/uv))
- **Docker & Docker-Compose**: ì „ì²´ ì„œë¹„ìŠ¤ ì‹¤í–‰ìš©

---

## ðŸ› ï¸ ì„¤ì¹˜ ë° ì„¤ì •

### 1. ê°€ìƒí™˜ê²½ êµ¬ì¶• ë° ì˜ì¡´ì„± ì„¤ì¹˜

`uv`ë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡œì íŠ¸ì— í•„ìš”í•œ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.

```bash
# ì˜ì¡´ì„± ì„¤ì¹˜ (ê°€ìƒí™˜ê²½ ìžë™ ìƒì„±)
uv sync

# íŠ¹ì • ê·¸ë£¹ì˜ ì˜ì¡´ì„±ë§Œ ì„¤ì¹˜í•˜ë ¤ëŠ” ê²½ìš°
uv sync --group app  # API ì„œë²„ìš©
uv sync --group ai   # AI ì›Œì»¤ìš©
```

### 2. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

`envs/` ë””ë ‰í† ë¦¬ì— ìžˆëŠ” ì˜ˆì‹œ íŒŒì¼ì„ ë³µì‚¬í•˜ì—¬ `.env` íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤.
- ë¡œì»¬ìš© 
    ```bash
    cp envs/example.local.env envs/.local.env
    ```
- ë°°í¬ìš© 
    ```bash
    cp envs/example.prod.env envs/.prod.env
    ```

ìƒì„±ëœ `env` íŒŒì¼ ë‚´ì˜ í™˜ê²½ë³€ìˆ˜ë“¤ì€ í”„ë¡œì íŠ¸ ìƒí™©ì— ë§žê²Œ ìˆ˜ì •í•˜ì„¸ìš”.

---

## ðŸƒ ì‹¤í–‰ ë°©ë²•

### 1. ë¡œì»¬ ë° ê°œë°œ í™˜ê²½

#### Docker Composeë¡œ ì „ì²´ ìŠ¤íƒ ì‹¤í–‰

ëª¨ë“  ì„œë¹„ìŠ¤(API, Worker, DB, Redis, Nginx)ë¥¼ í•œ ë²ˆì— ì‹¤í–‰í•©ë‹ˆë‹¤.

```bash
docker-compose up -d --build
```

ì‹¤í–‰ í›„ ë‹¤ìŒ ì£¼ì†Œë¡œ ì ‘ì† ê°€ëŠ¥í•©ë‹ˆë‹¤:
- **API ì„œë²„**: [http://localhost/api/docs](http://localhost/api/docs) (Swagger UI)
- **Nginx**: 80 í¬íŠ¸ë¥¼ í†µí•´ API ì„œë²„ë¡œ ìš”ì²­ì„ ì „ë‹¬í•©ë‹ˆë‹¤.

#### ë¡œì»¬ì—ì„œ ê°œë³„ ì‹¤í–‰ (ê°œë°œìš©)

**FastAPI ì„œë²„ ì‹¤í–‰:**
```bash
uv run uvicorn app.main:app --reload
# or
docker compose up -d --build app
```

**AI Worker ì‹¤í–‰:**
```bash
uv run python -m ai_worker.main
# or
docker compose up -d --build ai_worker
```

### 2. EC2 ë°°í¬ í™˜ê²½ (Production)

ì œê³µëœ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ AWS EC2 í™˜ê²½ì— ì´ë¯¸ì§€ë¥¼ ë¹Œë“œ, í‘¸ì‹œ ë° ë°°í¬í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

#### ì‚¬ì „ ì¤€ë¹„
- EC2 ì¸ìŠ¤í„´ìŠ¤ (Ubuntu ê¶Œìž¥)
- SSH í‚¤ íŽ˜ì–´ (`~/.ssh/` ê²½ë¡œì— ìœ„ì¹˜)
- ë„ì»¤ í—ˆë¸Œ(Docker Hub) ê³„ì • ë° Personal Access Token
- ë°°í¬ìš© í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (`envs/.prod.env`)
- ë„ë©”ì¸ êµ¬ë§¤ (Gabia, GoDaddy, AWS Route53 ë“±)

#### ìžë™ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
`scripts/deployment.sh`ëŠ” ë„ì»¤ ì´ë¯¸ì§€ ë¹Œë“œ, ë ˆí¬ì§€í† ë¦¬ í‘¸ì‹œ, EC2 ì ‘ì† ë° ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ê³¼ì •ì„ ìžë™í™”í•©ë‹ˆë‹¤.

```bash
chmod +x scripts/deployment.sh
./scripts/deployment.sh
```
ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì‹œ ë‹¤ìŒ ì •ë³´ë¥¼ ìž…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤:
1. ë„ì»¤ í—ˆë¸Œ ê³„ì • ì •ë³´ (Username, PAT)
2. ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•  ë ˆí¬ì§€í† ë¦¬ ì´ë¦„
3. ë°°í¬í•  ì„œë¹„ìŠ¤ ì„ íƒ (FastAPI, AI-Worker) ë° ë²„ì „(Tag)
4. SSH í‚¤ íŒŒì¼ëª… ë° EC2 IP ì£¼ì†Œ
5. https ì‚¬ìš©ì—¬ë¶€
   - 5-1. httpsì¸ ê²½ìš° ë„ë©”ì¸ ì¶”ê°€ ìž…ë ¥  

#### SSL(HTTPS) ì„¤ì • (Certbot)
ë„ë©”ì¸ì„ ì—°ê²°í•˜ê³  HTTPSë¥¼ ì ìš©í•˜ë ¤ë©´ `scripts/certbot.sh`ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

```bash
chmod +x scripts/certbot.sh
./scripts/certbot.sh
```
1. ë„ë©”ì¸ ì£¼ì†Œ ë° ì´ë©”ì¼ ìž…ë ¥
2. SSH í‚¤ íŒŒì¼ëª… ë° EC2 IP ì£¼ì†Œ ìž…ë ¥
3. Let's Encryptë¥¼ í†µí•œ ì¸ì¦ì„œ ë°œê¸‰ ë° Nginx ì„¤ì • ìžë™ ê°±ì‹  ì ìš©

---

## ðŸ§ª í…ŒìŠ¤íŠ¸ ë° í’ˆì§ˆ ê´€ë¦¬

ì œê³µëœ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì½”ë“œì˜ í’ˆì§ˆì„ ê²€ì¦í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

```bash
# í…ŒìŠ¤íŠ¸ ì‹¤í–‰
./scripts/ci/run_test.sh

# ì½”ë“œ í¬ë§·íŒ… í™•ì¸ (Ruff)
./scripts/ci/code_fommatting.sh

# ì •ì  íƒ€ìž… ê²€ì‚¬ (Mypy)
./scripts/ci/check_mypy.sh
```

---

## ðŸ“ ê°œë°œ ê°€ì´ë“œ

- **API ì¶”ê°€**: `app/apis/v1/` ì•„ëž˜ì— ìƒˆë¡œìš´ ë¼ìš°í„° íŒŒì¼ì„ ìƒì„±í•˜ê³  `app/apis/v1/__init__.py`ì— ë“±ë¡í•˜ì„¸ìš”.
- **DB ëª¨ë¸ ì¶”ê°€**: `app/models/`ì— Tortoise ëª¨ë¸ì„ ì •ì˜í•˜ê³  `app/db/databases.py`ì˜ `MODELS` ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€í•˜ì„¸ìš”.
- **AI ë¡œì§ ì¶”ê°€**: `ai_worker/tasks/`ì— ìƒˆë¡œìš´ ì²˜ë¦¬ ë¡œì§ì„ ìž‘ì„±í•˜ê³  `ai_worker/main.py`ì—ì„œ í˜¸ì¶œí•˜ë„ë¡ êµ¬ì„±í•˜ì„¸ìš”.
=======
# AI_04
>>>>>>> c4d4c2535ea0bd01fe1ae658f105cf710530d0bb
